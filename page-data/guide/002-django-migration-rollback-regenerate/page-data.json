{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/guide/002-django-migration-rollback-regenerate/","result":{"data":{"site":{"siteMetadata":{"title":"ìµœìˆ˜ë¯¼ ê°œë°œ ë¸”ë¡œê·¸","siteUrl":"https://sumini.dev"}},"markdownRemark":{"id":"f38160d9-36e7-5afe-b231-575ef28b4078","excerpt":"feature ë¸Œëœì¹˜ì—ì„œ ì‘ì—…í•˜ë˜ì¤‘ develop ë¸Œëœì¹˜ì— ìƒˆë¡œìš´ ë³€ê²½ ì‚¬í•­ë“¤ì´ ìƒê²¼ë‹¤. í™•ì¸í•´ë³´ë‹ˆ ë‘ ë¸Œëœì¹˜ì—ì„œ ê°™ì€ appë‚´ì˜ ëª¨ë¸ì„ ìˆ˜ì •í•´, ë„˜ë²„ë§ì´ ê²¹ì¹˜ëŠ” ë¬¸ì œê°€ ìƒê²¼ë‹¤. ğŸ˜… remote ë¸Œëœì¹˜ì˜ migrationsë¥¼ ë³´ì¡´í•˜ë©´ì„œ local ë¸Œëœì¹˜ì˜ migrationâ€¦","html":"<p>feature ë¸Œëœì¹˜ì—ì„œ ì‘ì—…í•˜ë˜ì¤‘ develop ë¸Œëœì¹˜ì— ìƒˆë¡œìš´ ë³€ê²½ ì‚¬í•­ë“¤ì´ ìƒê²¼ë‹¤.</p>\n<p>í™•ì¸í•´ë³´ë‹ˆ ë‘ ë¸Œëœì¹˜ì—ì„œ ê°™ì€ appë‚´ì˜ ëª¨ë¸ì„ ìˆ˜ì •í•´, ë„˜ë²„ë§ì´ ê²¹ì¹˜ëŠ” ë¬¸ì œê°€ ìƒê²¼ë‹¤. ğŸ˜…</p>\n<p>remote ë¸Œëœì¹˜ì˜ migrationsë¥¼ ë³´ì¡´í•˜ë©´ì„œ local ë¸Œëœì¹˜ì˜ migrationë“¤ì„ ì •ë¦¬í•´ë³´ì!</p>\n<h2 id=\"1-migration-conflict-í•´ê²°\" style=\"position:relative;\"><a href=\"#1-migration-conflict-%ED%95%B4%EA%B2%B0\" aria-label=\"1 migration conflict í•´ê²° permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. migration conflict í•´ê²°</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token function\">git</span> pull origin <span class=\"token operator\">&lt;</span>remote_branch_name<span class=\"token operator\">></span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 130px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 80.76923076923077%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAADkUlEQVQ4y0WU6VIbRxSFlarkDVJOwJqtp2dG+wbWiiWhDYEQaAPHkuMCl2NjJCMwS7ADqfxw/CMvkFTyBskL+C3yAHmYLzUtyv5x6ty+XVPd9/Q5E3CEhRUvsFR/hXQ8HOlQq9WpVCpUq1Wq1XUqlaqqhbAJhcJkMivk8wWKxRKRSJRms0UikaRebxCwnQjxZzf8+OdL3k3v4bgpZtNjzs7ecH19zYcPH7i5ueX09IzV1Qfc3NxwcXGh+OTkhFgszvX1W87Pz7m9/ZnAsh7j4DDBv/98QaNsYgmPVqtFrV6n0WiysdFmo91mu9tlMBgqbG11aLc32d3t0Wy11BSdTod6o0FASoeQrRNxTYKah+M4GEEDQ/sMPahj6v5hAl03MHTz057/vWlaGOaiF3BtCz3T5NvuO+JxF2lLooUMkQcpItnUgnNpwqtJpa9jO3jRCKFkjPBKEsd1cVwPR0jCmQQBy4mRP37L73/3+WV+D82Jkfthm9y0T+FsxNrthML5nlp7iSi51wNyr3YpvNkj+6KLGw0rzh7tUrx8ROC+HmGyL/n4x5c8yAiE9Eh3yyS3y6R2KqSHNVLbZTKjOqndKqtPN0mPaqqf3quT2CiSedQks98g1a0Q8DUTpkBbNhHCVWP5Wpg+fC2DutLUMiw1mm0IpGUv2JY4nqfW0rQVBxxbIKNp9LU9TMtDSkmhWCSbzSnk8nkKhaKyjG1L7LtHkI6rfOnDErbqWZYgoMz83Vse//aOk8MlXC/JdHrM/PSUq6sr3r//lcvLK2azGel0Rnnv4uKS+XzObPaao6Mjnj9/znx+ynQ6I7BkxDk8LvHfx68YdTQsEabX22VnZ4d+v89wOKQ/GDAej9nc3FKYTCYqHZ3ONqPRHr1ej+FwxHg8IWDbDgkvyFpmiaC+8KHvO10z0II62n2d+8tBNZqfCl3T0TR94T3DVPC9qXr+yL4PjViJryvHuL7Avg9TCcLxqOJYOkF8NYUbCiFdl0g8hrQkrushhUToQtW+P/36U5av/3rJT9NvMOwItSdtGs92qIzbrH+/RfNFj/TDLNmNNVovejzca2JbNqV+jcrjttpff9qhvN+6y/JBXGW5/tBEyBBr/RqlQV0hVVql0K2S75RZWc+T3ypTO9gmWVihOt6kftil+mRTYf3J1iLLnhSEQi6asfh92UKqGyi+q30JfAhDIEyb2EpS5djSrEXPEFi6xf9ZHRyU72IwmQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Local conflict\"\n        title=\"Local conflict\"\n        src=\"/static/4a3080000063031628b5caa463fbb92d/ffd64/1_local_conflict.png\"\n        srcset=\"/static/4a3080000063031628b5caa463fbb92d/ffd64/1_local_conflict.png 130w\"\n        sizes=\"(max-width: 130px) 100vw, 130px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>ìœ„ ì‚¬ì§„ê³¼ ê°™ì´ 69ë²ˆ migrationì´ ì¤‘ë³µìœ¼ë¡œ ìƒì„±ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤!<br>\nroll back í›„ ë‹¤ì‹œ migrationì„ ìƒì„±í•´ í•´ê²°í•´ë³´ì</p>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># conflicted migration files ì‚­ì œ</span>\n$ <span class=\"token function\">rm</span> 0069_add_selects_request.py\n$ <span class=\"token function\">rm</span> 0070_fix_selects_request_sns_link,content.py</code></pre></div>\n<p>local ë¸Œëœì¹˜ì—ì„œ ì‘ì—…í•œ migration íŒŒì¼ë“¤ì„ ëª¨ë‘ ì‚­ì œí•œë‹¤.</p>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># migration ë¡¤ë°± í›„ remote ì ìš©</span>\n$ ./manage.py migrate items 0068_add_follwers_count.py\n$ ./manage.py migrate</code></pre></div>\n<p>base ìƒíƒœë¡œ ë˜ëŒì•„ê°„ í›„ <code class=\"language-text\">migrate</code> ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•´ remove ë¸Œëœì¹˜ì˜ migrationì„ ì ìš©í•œë‹¤.</p>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># migration ì¬ìƒì„±</span>\n$ ./manage.py makemigrations items</code></pre></div>\n<p>local ë¸Œëœì¹˜ì˜ ë³€ê²½ì„ ë°˜ì˜í•˜ê¸° ìœ„í•œ migration íŒŒì¼ì„ ìƒˆë¡œ ìƒì„±í•œë‹¤! ì´í›„ íŒŒì¼ëª…ì„ ì ì ˆí•˜ê²Œ ë°”ê¿”ì¤€ë‹¤.</p>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 153px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.980392156862756%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACX0lEQVQozz2Q204TYRSF5wH0wniB9HycmZZ2OjOlpynt9ERpSxBaWjQ1YCqFcD6VFAqCeKGJt974BN4Y38FH+8z8iV7srL3W3vn/tbYUSyRQNIP5xiGxdBbN0Gm02tSWmyy32jTbHSr1BspCAs0wsUplrLJNOpfHrtXJFCwaKy2ShilKUlUFtT3ky889HiZezGyF6e2U88srPj5+4vHpiePTM9Z7m6K/nk65md2Jjxz9enrD49NnsT+9nSHJ8SR61uTHwzPqdgR5wSBnWWTyBRbzBeGgVKmy0lmlXK0Jh6VqlXpzRcwcnrWKFEplCkslpKisEAkGeREo8sqXRI5GkBUVWVaIRuX/6PcHcHu8eJzy+vD6/Hi9PtxuD/5AEJ/PL3QpGgwQKnSo3H9lZxhBTy1ycnLM/v4+V1cTLi+v2N0dUyhYjHfHjEYfGI1GDIfv2Np6w3g8pmJXsG2b7e0dpFAgRHLJ5s9vF3tv54gqBr1el7W11/T7fbrdHoPBFq1Wm42NLpubfTqdVTFzuPPo+vqG2On3B0gRJ1bITzo2h8crEwqFRQwnmoPz8y4CgSDhcERwl8uN2+0VEf9xZ+6cxOmlaCRCWNV4WT0jYWok4nHhZnm5SbvdEQ5NM42iqORyOer1OqVSGVWNCd2yihSLS2haCtuuIIX9fpTGgO+/hjycz5HU8lxcnHN0dCTu5GC322Vn5z339/fMZnccHBxQq9VFP5lcM5vNODw84uTkFCkUlkkkFb5dPidrBgmFVXRdJ5XSiccXhJN/LgzDRNcNMpms0NLpRVKplHDn6Mmkxl/N6l++Yw539wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Result\"\n        title=\"Result\"\n        src=\"/static/fcc3c2bbf66ce2959b404671207f1af7/3bda9/2_result.png\"\n        srcset=\"/static/fcc3c2bbf66ce2959b404671207f1af7/3bda9/2_result.png 153w\"\n        sizes=\"(max-width: 153px) 100vw, 153px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>ê¹”ë”í•˜ê²Œ ë°˜ì˜ëë‹¤ ã…</p>\n<h2 id=\"2-db-conflict-í•´ê²°\" style=\"position:relative;\"><a href=\"#2-db-conflict-%ED%95%B4%EA%B2%B0\" aria-label=\"2 db conflict í•´ê²° permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. DB conflict í•´ê²°</h2>\n<p>migrate í›„ì— í…ŒìŠ¤íŠ¸ë¥¼ ëŒë ¤ë³´ë‹ˆ <span style=\"color:red\">django.db.utils.ProgrammingError: relation already exists</span> ì—ëŸ¬ê°€ ë°œìƒí–ˆë‹¤!</p>\n<p>ì´ìœ ëŠ” rollbackì „ì— ìƒì„±í•œ local migrationì—ì„œ ì´ë¯¸ ìƒˆë¡œìš´ ëª¨ë¸ì˜ relationì„ ìƒì„±í–ˆëŠ”ë°, rollbackí•˜ê³  ë‹¤ì‹œ ìƒì„±í•˜ëŠ” ê³¼ì •ì—ì„œ relationì´ ì‚­ì œë˜ì§€ ì•Šê³  ë‚¨ì•„ìˆë˜ ê²ƒì´ë‹¤.</p>\n<p>ì´ë¥¼ í•´ê²°í•˜ê¸°ìœ„í•œ ì—¬ëŸ¬ê°€ì§€ ë°©ë²•ì´ ìˆì§€ë§Œ, ì‹¤ìˆ˜ ê°€ëŠ¥ì„± ì—†ì´ ê¹”ë”í•˜ê²Œ í•´ê²°í•˜ê¸° ìœ„í•´ DBë¥¼ ì´ˆê¸°í™” í•´ë³´ê² ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># postgresql cli ì ‘ì†</span>\n$ psql\n\n<span class=\"token comment\"># ë°ì´í„°ë² ì´ìŠ¤ dropí›„ ì¬ìƒì„±</span>\n<span class=\"token assign-left variable\">postgres</span><span class=\"token operator\">=</span><span class=\"token comment\"># drop database &lt;local_db_name>;</span>\n<span class=\"token assign-left variable\">postgres_test</span><span class=\"token operator\">=</span><span class=\"token comment\"># create database &lt;local_db_name> encoding 'utf-8';</span>\n<span class=\"token assign-left variable\">postgres_test</span><span class=\"token operator\">=</span><span class=\"token comment\"># grant all privileges on database &lt;local_db_name> to &lt;local_user_name>;</span>\n\n<span class=\"token comment\"># production db dump</span>\n$ pg_dump <span class=\"token parameter variable\">-U</span> <span class=\"token operator\">&lt;</span>user_name<span class=\"token operator\">></span> <span class=\"token parameter variable\">-h</span> <span class=\"token operator\">&lt;</span>host<span class=\"token operator\">></span> <span class=\"token parameter variable\">-p</span> <span class=\"token operator\">&lt;</span>port_number<span class=\"token operator\">></span> <span class=\"token parameter variable\">-d</span> <span class=\"token operator\">&lt;</span>db_name<span class=\"token operator\">></span> <span class=\"token operator\">></span> production.sql\n$ psql <span class=\"token operator\">&lt;</span>local_db_name<span class=\"token operator\">></span> <span class=\"token parameter variable\">-U</span> <span class=\"token operator\">&lt;</span>local_user_name<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span> production.sql</code></pre></div>\n<ol>\n<li>local dbë¥¼ dropí›„ ì¬ìƒì„±í•œë‹¤.</li>\n<li>ì„œë¹„ìŠ¤ì¤‘ì¸ production dbë¥¼ dumpí•´ì„œ ê°€ì ¸ì˜¨ë‹¤.</li>\n<li>dumpí•œ íŒŒì¼ ë‚´ìš©ì„ local dbì— ì ìš©í•œë‹¤.</li>\n</ol>\n<p>ë‹¤ì‹œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©´ ì˜ ëŒì•„ê°„ë‹¤ âœ¨</p>","tableOfContents":"<ul>\n<li><a href=\"#1-migration-conflict-%ED%95%B4%EA%B2%B0\">1. migration conflict í•´ê²°</a></li>\n<li><a href=\"#2-db-conflict-%ED%95%B4%EA%B2%B0\">2. DB conflict í•´ê²°</a></li>\n</ul>","fields":{"slug":"/guide/002-django-migration-rollback-regenerate/"},"frontmatter":{"title":"Django migration ë¡¤ë°±, ì¬ìƒì„± ë°©ë²•","date":"2020-09-15T02:27:10.169Z","tags":["django","migration"],"thumbnail":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABDElEQVQoz3WQWY6EMAxEuf+5uhu+G3GEYc1GErZAUiMbgcRIE6l+4vJz2VkIO5yfoLVB1/cYhGD1/YDX6w1rLWJK7DFmRD8MkFKxlFIQUrJfKoVlWZBdQCp2XX9CB4G6aVAUxQmMCdZ5KKUfHhqqtWboOFrQY6BnoL6NV9r35wPvPWKMcN5DG8MQTkQJtWZRjxlHpHQBpwmjtRybmqhIpjzPH0BDwOEEUiqCEVgIwefYtg3ZFgKc85jn+RGdIFVVwTl3r8zrCcmD266DlBI/dc3DCdy0LbKUEkgEOI6DRYAQAr7fLwOPGBlIR6dz0F8CcPVe4hvin7fvO8qyvJuXdcW6rrz6NE08lEL81S/sqRfFGYBiUgAAAABJRU5ErkJggg==","aspectRatio":2.6785714285714284,"src":"/static/ff30f46b8b7bd2e06ace543fcf0e41fc/8c781/0_conflict.png","srcSet":"/static/ff30f46b8b7bd2e06ace543fcf0e41fc/630fb/0_conflict.png 300w,\n/static/ff30f46b8b7bd2e06ace543fcf0e41fc/8c781/0_conflict.png 505w","sizes":"(max-width: 505px) 100vw, 505px"}}}}}},"pageContext":{"slug":"/guide/002-django-migration-rollback-regenerate/","previous":{"excerpt":"window.location.searchë¥¼ ì½ì–´, ì‚¬ìš©í•˜ê¸° ì¢‹ì€ object í˜•íƒœë¡œ ë§Œë“¤ì–´ì•¼ í•œë‹¤. ì´ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆëŠ” ì—¬ëŸ¬ ë¼ì´ë¸ŒëŸ¬ë¦¬(react-router, react-router-dom, use-react-routerâ€¦","fields":{"slug":"/guide/001-how-to-get-query-parameters-using-react-hooks/"},"frontmatter":{"date":"2020-09-10T02:41:10.169Z","title":"Query Parameter Hook ë§Œë“¤ê¸°","layout":"post","thumbnail":{"childImageSharp":{"fluid":{"originalImg":"/static/3637df1098a590708a1fd467f0768599/f9913/hooks.jpg"}}}}},"next":{"excerpt":"Next.js ê°œë°œí™˜ê²½ì—ì„œ window objectë¥¼ ì‚¬ìš©í•  ë•Œ, document is undefined, Cannot read innerWidth of undefined ë“±ì˜ ì—ëŸ¬ë©”ì„¸ì§€ë¥¼ ë§ˆì£¼í•  ë•Œê°€ ìˆë‹¤. Next.jsâ€¦","fields":{"slug":"/issue/000-nextjs-window,document-is-not-defined/"},"frontmatter":{"date":"2020-09-15T03:19:10.169Z","title":"Next.js \"window,document is not defined\" í•´ê²°í•˜ëŠ” ë²•","layout":"post","thumbnail":{"childImageSharp":{"fluid":{"originalImg":"/static/bbc016fa1685c64a2b61da4817186d6c/3225f/nextjs.png"}}}}}}},"staticQueryHashes":["1845200029","3000541721"]}